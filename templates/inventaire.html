{% extends "base.html" %}

{% block title %}Inventaire Complet - LabFlow{% endblock %}

{% block content %}

    <div class="main-container" data-add-url="{{ url_for('inventaire.ajouter_objet') }}">
        
        <!-- BARRE DE FILTRES PREMIUM -->
		<div class="filter-bar-container mb-4 fade-in-down">
			<div class="filter-bar">
				
				<!-- Filtre Armoire -->
				<div class="filter-group">
					<div class="filter-icon">
						<i class="bi bi-archive"></i>
					</div>
					<div class="filter-content">
						<label for="filtre-armoire" class="filter-label">Armoire</label>
						<select id="filtre-armoire" class="filter-select">
							<option value="">Toutes</option>
							{% for a in armoires %}
								<option value="{{ a.id }}" {% if armoire_id == a.id %}selected{% endif %}>{{ a.nom }}</option>
							{% endfor %}
						</select>
					</div>
				</div>

				<div class="filter-separator"></div>

				<!-- Filtre Catégorie -->
				<div class="filter-group">
					<div class="filter-icon">
						<i class="bi bi-tags"></i>
					</div>
					<div class="filter-content">
						<label for="filtre-categorie" class="filter-label">Catégorie</label>
						<select id="filtre-categorie" class="filter-select">
							<option value="">Toutes</option>
							{% for c in categories %}
								<option value="{{ c.id }}" {% if categorie_id == c.id %}selected{% endif %}>{{ c.nom }}</option>
							{% endfor %}
						</select>
					</div>
				</div>

				<div class="filter-separator"></div>

				<!-- Filtre État -->
				<div class="filter-group">
					<div class="filter-icon">
						<i class="bi bi-heart-pulse"></i>
					</div>
					<div class="filter-content">
						<label for="filtre-etat" class="filter-label">État</label>
						<select id="filtre-etat" class="filter-select">
							<option value="">Tous</option>
							<option value="stock" {% if request.args.get('etat') == 'stock' %}selected{% endif %}>Stock bas</option>
							<option value="bientot" {% if request.args.get('etat') == 'bientot' %}selected{% endif %}>Péremption proche</option>
							<option value="perime" {% if request.args.get('etat') == 'perime' %}selected{% endif %}>Périmé</option>
						</select>
					</div>
				</div>

				<!-- Bouton Reset -->
				<div class="filter-actions">
					<a href="{{ url_for('inventaire.inventaire') }}" class="btn-reset-filters" title="Réinitialiser les filtres">
						<i class="bi bi-arrow-counterclockwise"></i>
					</a>
				</div>

			</div>
		</div>

        <div class="d-flex justify-content-between align-items-center mb-4 pb-3 border-bottom">
			<h2 class="h3 mb-0 text-dark d-flex align-items-center gap-3">
				<!-- Icône Inventaire (Style Carte Admin : Dégradé Bleu) -->
				<div class="rounded-3 d-flex align-items-center justify-content-center text-white shadow-sm" 
					 style="width: 48px; height: 48px; background: linear-gradient(135deg, #0d6efd 0%, #0dcaf0 100%);">
					<svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" fill="currentColor" class="bi bi-credit-card-2-front-fill" viewBox="0 0 16 16">
					  <path d="M0 4a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2zm2.5 1a.5.5 0 0 0-.5.5v1a.5.5 0 0 0 .5.5h2a.5.5 0 0 0 .5-.5v-1a.5.5 0 0 0-.5-.5zm0 3a.5.5 0 0 0 0 1h5a.5.5 0 0 0 0-1zm0 2a.5.5 0 0 0 0 1h1a.5.5 0 0 0 0-1zm3 0a.5.5 0 0 0 0 1h1a.5.5 0 0 0 0-1zm3 0a.5.5 0 0 0 0 1h1a.5.5 0 0 0 0-1zm3 0a.5.5 0 0 0 0 1h1a.5.5 0 0 0 0-1z"/>
					</svg>
				</div>
				<span class="fw-bold">Liste Générale des Objets</span>
			</h2>
			
			<!-- Bouton d'action (Conservé) -->
			<div class="page-actions-container">
				{% if session.user_id %}
				<button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#addObjectModal">
					<i class="bi bi-plus-circle-fill me-2"></i> Ajouter un matériel
				</button>
				{% endif %}
			</div>
		</div>

        {% if objets %}
            <div id="dynamic-content" data-endpoint="inventaire" data-sort-by="{{ sort_by }}" data-direction="{{ direction }}">
                {% include '_inventaire_content.html' %}
            </div>
        {% else %}
            <div class="empty-state-container">
                <div class="empty-state-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" class="page-title-icon" viewBox="0 -960 960 960"><path d="M200-80q-33 0-56.5-23.5T120-160v-640q0-33 23.5-56.5T200-880h560q33 0 56.5 23.5T840-800v640q0 33-23.5 56.5T760-80H200Zm0-80h560v-640H200v640Zm140-40h280v-280h-80v120l-60-60-60 60v-120h-80v280Zm-60-320h400v-80H280v80Z"/></svg>
                </div>
                <h3>Votre inventaire est vide</h3>
                <p>Commencez par ajouter votre premier objet pour peupler votre inventaire.</p>
                {% if session.user_id %}
                <button class="btn btn-primary mt-3" data-bs-toggle="modal" data-bs-target="#addObjectModal">
                    Ajouter le premier objet
                </button>
                {% endif %}
            </div>
        {% endif %}
    </div>

	{% include '_modale_danger.html' %}
{% endblock %}

{% block scripts %}
    <!-- Pas de script spécifique nécessaire pour cette page -->
{% endblock %}