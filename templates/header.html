<header class="app-header">
    <div class="header-container">
        <div class="header-brand">
			<a href="{{ url_for('inventaire.index') }}">
				<h1>{{ nom_etablissement or 'Mon Espace' }}</h1>
				<p class="brand-subtitle">LabFlow</p>
			</a>
		</div>
        <div class="header-right">
            <div class="search-container">
                <!-- AJOUT : L'icône SVG de la loupe est de retour -->
                <svg class="search-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 -960 960 960"><path d="M784-120 532-372q-30 24-69 38t-83 14q-109 0-184.5-75.5T120-580q0-109 75.5-184.5T380-840q109 0 184.5 75.5T640-580q0 44-14 83t-38 69l252 252-56 56ZM380-400q75 0 127.5-52.5T560-580q0-75-52.5-127.5T380-760q-75 0-127.5 52.5T200-580q0 75 52.5 127.5T380-400Z"/></svg>
                <input type="search" id="recherche-objet" placeholder="Rechercher un objet..." autocomplete="off">
                <div id="search-results-container"></div>
            </div>
            
            <a href="{{ url_for('main.panier') }}" class="header-icon-link" title="Panier de réservation">
				<svg class="header-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M7 18c-1.1 0-1.99.9-1.99 2S5.9 22 7 22s2-.9 2-2-.9-2-2-2zM1 2v2h2l3.6 7.59-1.35 2.45c-.16.28-.25.61-.25.96 0 1.1.9 2 2 2h12v-2H7.42c-.14 0-.25-.11-.25-.25l.03-.12.9-1.63h7.45c.75 0 1.41-.41 1.75-1.03l3.58-6.49c.08-.14.12-.31.12-.48 0-.55-.45-1-1-1H5.21l-.94-2H1zm16 16c-1.1 0-1.99.9-1.99 2s.89 2 1.99 2 2-.9 2-2-.9-2-2-2z"/></svg>
				<span id="cart-count-badge" class="cart-count-badge" style="display: none;">0</span>
			</a>
            
            <a href="{{ url_for('main.alertes') }}" id="alert-icon-link" class="header-icon-link" ...>
				<svg class="header-icon 
                    {% if alertes_total > 3 %}
                        alert-critical pulse-fast
                    {% elif alertes_total > 0 %}
                        alert-warning pulse
                    {% else %}
                        alert-ok
                    {% endif %}" 
                    xmlns="http://www.w3.org/2000/svg" height="28px" viewBox="0 0 24 24" width="28px">
                    <path d="M12 23c1.1 0 1.99-.89 1.99-1.99h-3.98c0 1.1.89 1.99 1.99 1.99zm7-6v-6c0-3.35-2.36-6.15-5.5-6.83V1.5h-3v2.67C7.36 4.85 5 7.65 5 11v6l-2 2v1h18v-1l-2-2zm-6-1h-2v-2h2v2zm0-4h-2V8h2v4z"/>
                </svg>
				{% if alertes_total and alertes_total > 0 %}
					<span class="notification-badge">{{ alertes_total }}</span>
				{% endif %}
			</a>

            <div class="auth-section">
                {% if session.user_id %}
                    <a href="{{ url_for('auth.profil') }}" class="header-icon-link" title="Gérer mon profil">
                        <svg class="profile-link-svg" xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px"><path d="M600-120h240v-33q-25-23-56-35t-64-12q-33 0-64 12t-56 35v33Zm120-120q25 0 42.5-17.5T780-300q0-25-17.5-42.5T720-360q-25 0-42.5 17.5T660-300q0 25 17.5 42.5T720-240ZM480-480Zm2-140q-58 0-99 41t-41 99q0 48 27 84t71 50q0-23 .5-44t8.5-38q-14-8-20.5-22t-6.5-30q0-25 17.5-42.5T482-540q15 0 28.5 7.5T533-512q11-5 23-7t24-2h36q-13-43-49.5-71T482-620ZM370-80l-16-128q-13-5-24.5-12T307-235l-119 50L78-375l103-78q-1-7-1-13.5v-27q0-6.5 1-13.5L78-585l110-190 119 50q11-8 23-15t24-12l16-128h220l16 128q13 5 24.5 12t22.5 15l119-50 110 190-85 65H696q-1-5-2-10.5t-3-10.5l86-65-39-68-99 42q-22-23-48.5-38.5T533-694l-13-106h-79l-14 106q-31 8-57.5 23.5T321-633l-99-41-39 68 86 64q-5 15-7 30t-2 32q0 16 2 31t7 30l-86 65 39 68 99-42q24 25 54 42t65 22v184h-70Zm210 40q-25 0-42.5-17.5T520-100v-280q0-25 17.5-42.5T580-440h280q25 0 42.5 17.5T920-380v280q0 25-17.5 42.5T860-40H580Z"/></svg>
                    </a>
                    <span class="welcome-message">Bonjour, {{ session.username }}</span>
                    <a href="{{ url_for('auth.logout') }}" class="btn btn-sm btn-outline-light">Se déconnecter</a>
                {% else %}
                    <a href="{{ url_for('auth.login') }}" class="auth-link">Connexion</a>
                {% endif %}
            </div>
        </div>
    </div>
</header>